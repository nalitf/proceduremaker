# schememaker
#### はじめに  

化学実験スキーム（プロトコル）の図の作成を支援するためのExcelマクロです。  
このマクロを使用したことによって生じた不利益に対して作成者は一切の責任を負いません。  
改変などは自由に行ってください。また、改善点などあれば是非教えてください。

このマクロの再配布は禁止します。  
なお、参考元サイトを末尾に付記しています。

2021.07.18 Sana

***

## 【使い方】

**A列**には以下の操作種別を入力してください
  
    begin  縦矢印の始点を決定  
    end    縦矢印の終点を決定

    以下のコマンドはbegin-endの中で使ってください  
        add         試薬や溶媒などを加える
        bar         横線の描画
        stir        攪拌する
        envbegin    実験環境の始点（窒素下, Gloveboxなど）
        envend      実験環境の終点
        ※envbegin-envendは必ず対で使ってください

    以下のコマンドはbegin-endの外で使ってください
        wu      ワークアップ操作
    
    以下のコマンドはどこでも使用可能です
        space   空行を作成

**begin**, **add**, **bar**, **stir**, **envbegin**, **envend**, **wu** は<u>**B列**に説明を記載</u>できます  
**space** は<u>**B列**に空白行数を指定</u>できます（小数可）。

いくつかのパラメータをシート上で調整できます。
**行間隔**：文字の行間隔を調整します。（デフォルト値：15）  
**横線長さ1**：**envbegin/end**, **bar**の横線および**begin/end**の横線の左側の長さを調整します。（デフォルト値：15）    
**横線長さ2**：**begin/end**の横線の右側の長さを調整します。（デフォルト値：175）  
**横矢印長さ**：**add**の矢印の長さを調整します。（デフォルト値：30）

図はグループ化された図形オブジェクトとして出力されます。
出力された図はCopy/Pasteでパワポに貼り付けられます。フォントサイズなどもそちらで調整可能です。グループ解除して個別編集も可能です。  

シート上にある**GENERATE**セルをダブルクリックすると図を出力します。（<u>C4セルを指定して動作していますので、動かさないでください</u>）または、scehemeakerモジュールを**表示タブ>マクロ**から直接実行してください。  
また、シート上にある**CLEAR**セル（C5セル）をダブルクリックするとシート上のすべての図形を消去します。（出力した図ではなく、シート内のすべての図形オブジェクトを一括削除することに注意してください。）  

***

## 【更新履歴】

2021.08.06
* 上付き/下付き文字に対応しました。
* これに伴いコード内のテキスト表示に関する記述を関数化しました。
* **bar**, **begin/end**の横線の長さと**add**の矢印の長さをシート上で調整できるようにしました。

2021.07.31
* ~~**begin**/**end**の上下端の横線の長さをコード冒頭で変数として指定する方式に変更しました。~~
* ~~必要に応じてVBAコード冒頭のBarLen2の値を変更してください。~~ 21.08.06仕様変更
* **begin**/**end**の横線の左側の長さを**bar**および**envbegin**/**envend**の長さと統一しました。（変数名はBarLenです）

2021.07.24
* 各描画要素を移動基準点（OrientX,Y）をもとに描画する方式に変更しました。  
* これに伴い複数の縦矢印を挿入できるようになりました。  
　※初版では特定のセルを基準点としていたため複数の矢印を挿入できませんでした  
* **space**, **bar**, **envbegin**/**envend**コマンドを追加しました。  
* 一部の不正な操作に対してエラーメッセージが出るようにしました。

2021.07.18
* 試作版を作成・公開しました｡

***
### 【参考サイト一覧】
http://officetanaka.net/excel/vba/tips/tips177.htm  
https://jizilog.com/vba-textboxop  
https://qiita.com/HMMNRST/items/4c16cb1ed7070965ea5a  
https://lilia-study.com/excel/excel-vba/sheet/beforedoubleclick.html  
https://kokodane.com/2013_macro_40.htm  
https://www.relief.jp/docs/excel-macro-delete-all-shapes.html

